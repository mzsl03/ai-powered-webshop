{% extends 'layout.html' %}

{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="{% static 'css/cart.css' %}">
{% endblock %}

{% block main %}
    <div id="cart-container">
        <table class="cart-list">
            <tr class="cart-header">
                <th>Termékek</th>
                <th>Darabszám</th>
                <th>Szín</th>
                <th>Tárhely</th>
                <th>Státusz</th>
                <th>Rendelés ideje</th>
            </tr>

            {% if orders %}
                {% for order in orders %}
                    <tr class="cart-items">
                        <td>
                            {% for item in order.items.all %}
                                {{ item.product.name }}{% if not forloop.last %}, {% endif %}
                                {% empty %}
                                -
                            {% endfor %}
                        </td>
                        <td>
                            {% with total_qty=0 %}
                                {% for item in order.items.all %}
                                    {% widthratio total_qty|add:item.quantity 1 1 as total_qty %}
                                {% endfor %}
                                {{ order.items.all|length }} tétel
                            {% endwith %}
                        </td>
                        <td>
                            {% for item in order.items.all %}
                                {{ item.color }}{% if not forloop.last %}, {% endif %}
                                {% empty %}
                                -
                            {% endfor %}
                        </td>
                        <td>
                            {% for item in order.items.all %}
                                {% if item.storage %}
                                    {% if item.storage > 100 %}
                                        {{ item.storage }} GB{% if not forloop.last %}, {% endif %}
                                    {% else %}
                                        {{ item.storage }} TB{% if not forloop.last %}, {% endif %}
                                    {% endif %}
                                {% else %}
                                    -
                                {% endif %}
                                {% empty %}
                                -
                            {% endfor %}
                        </td>
                        <td>{{ order.get_status_display }}</td>
                        <td>{{ order.order_time|date:"Y-m-d H:i" }}</td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr class="cart-items">
                    <td colspan="6">Nincsenek rendeléseid</td>
                </tr>
            {% endif %}
        </table>
    </div>
{% endblock %}